# 监控程序

32位RISC-V监控程序

## 依赖库

riscv-gnu-toolchain(32位)

## 使用方法

修改Makefile中riscv-gnu-toolchain的路径,之后执行`make ON_FPGA=y`,生成二进制文件kernel.bin 使用make show-utest信号查看测试代码地址.

## 地址划分

监控程序使用了 8 MB 的内存空间，其中约 1 MB 由 Kernel 使用，剩下的空间留给用户程序。此外，为了支持串口通信，还设置了一个内存以外的地址区域，用于串口收发。具体内存地址的分配方法如下表所示：

| 虚地址空间             | 说明       |
|:--------------------:|:---------:|
|0x80000000-0x800FFFFF |监控程序代码 |
|0x80100000-0x803FFFFF |用户程序代码 |
|0x80400000-0x807EFFFF |用户数据空间 |
|0x807F0000-0x807FFFFF |监控程序数据 |
|0xBFD003F8-0xBFD003FD |串口数据及状态|
串口控制器访问的代码位于`kern/utils.S`，其数据格式为：

| 地址          |位    | 说明 |
|:------------:|:----:|:----|
| 0xBFD003F8   |[7:0] |串口数据，读、写改地址表示通过串口接收、发送一个字节
| 0xBFD003FC   |[0]   |只读，为1时表示串口空闲，可以发送数据 |
| 0xBFD003FC   |[1]   |只读，为1时表示串口收到数据 |
